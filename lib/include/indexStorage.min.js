var indexStorage;indexStorage=class{constructor(e){this.node_env=null!=e&&e.NODE_ENV||"",this.version=1,this.__indexDBObj=void 0,this.__IDBTransactionObj=void 0,this.__IDBKeyRangeObj=void 0,this.__database=void 0,window.indexedDB&&(this.__indexDBObj=window.indexedDB,this.__IDBTransactionObj=window.IDBTransaction,this.__IDBKeyRangeObj=window.IDBKeyRange,"develop"===this.node_env?this.__dbname="__indexstorage_db_develop__":this.__dbname="__indexstorage_db_production__")}__connectDB(){return new Promise((e,t)=>{var r;return(r=this.__indexDBObj.open(this.__dbname,this.version)).onupgradeneeded=(e=>{var t,r,a;return(a=(t=e.target.result).createObjectStore("indexStorage",{keyPath:"key"})).createIndex("primary_key","key",{unique:!0,multiEntry:!1}),(a=t.createObjectStore("preference",{keyPath:"key"})).createIndex("primary_key","key",{unique:!0,multiEntry:!1}),r=[],a.put({key:"keylist",val:r})}),r.onsuccess=(t=>(this.__database=t.target.result,e(!0))),r.onerror=(e=>t(!1))})}__addKeylist(e){return new Promise(async(t,r)=>{var a;return(a=await this.getItem("keylist","preference")).indexOf(e)<0&&(a.push(e),await this.setItem("keylist",a,"preference")),t(a)})}__removeKeylist(e){return new Promise(async(t,r)=>{var a,n;return(a=(n=await this.getItem("keylist","preference")).indexOf(e))>=0&&(n.splice(a,1),await this.setItem("keylist",n,"preference")),t(n)})}length(){return new Promise(async(e,t)=>{var r,a;try{return await this.__connectDB(),r=this.__database.transaction(["indexStorage"],"readonly").objectStore("indexStorage"),(a=r.count()).onerror=(e=>(this.__database.close(),t(void 0))),a.onsuccess=(t=>{var r;return r=a.result,e(r)})}catch(e){}})}key(e){return new Promise(async(t,r)=>{try{return t((await this.getItem("keylist","preference"))[parseInt(e)])}catch(e){return e,r(void 0)}})}getItem(e,t="indexStorage"){return new Promise(async(r,a)=>{var n,s;return await this.__connectDB(),n=this.__database.transaction([t],"readonly").objectStore(t),(s=n.get(e)).onerror=(e=>(this.__database.close(),a(void 0))),s.onsuccess=(t=>{var a;return a=void 0,null!=s.result&&s.result.key===e&&(a=s.result.val),this.__database.close(),r(a)})})}setItem(e,t,r="indexStorage"){return new Promise(async(a,n)=>{var s;return await this.__connectDB(),(s=this.__database.transaction([r],"readwrite")).objectStore(r).put({key:e,val:t}),"indexStorage"===r&&await this.__addKeylist(e),s.onerror=(e=>(this.__database.close(),n(!1))),s.oncomplete=(e=>(this.__database.close(),a(!0)))})}removeItem(e,t="indexStorage"){return new Promise(async(r,a)=>{var n;return await this.__connectDB(),(n=this.__database.transaction([t],"readwrite").objectStore(t).delete(e)).onerror=(e=>(this.__database.close(),a(!1))),n.onsuccess=(async t=>(await this.__removeKeylist(e),this.__database.close(),r(!0)))})}clear(e="indexStorage"){return new Promise(async(t,r)=>{var a;return await this.__connectDB(),(a=this.__database.transaction([e],"readwrite").objectStore(e).clear()).onerror=(e=>(this.__database.close(),r(!1))),a.onsuccess=(e=>(this.__database.close(),t(!0)))})}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIjAiXSwibmFtZXMiOlsiaW5kZXhTdG9yYWdlIiwiW29iamVjdCBPYmplY3RdIiwicGFyYW0iLCJ0aGlzIiwibm9kZV9lbnYiLCJOT0RFX0VOViIsInZlcnNpb24iLCJfX2luZGV4REJPYmoiLCJfX0lEQlRyYW5zYWN0aW9uT2JqIiwiX19JREJLZXlSYW5nZU9iaiIsIl9fZGF0YWJhc2UiLCJ3aW5kb3ciLCJpbmRleGVkREIiLCJJREJUcmFuc2FjdGlvbiIsIklEQktleVJhbmdlIiwiX19kYm5hbWUiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsInJlcU9iaiIsIm9wZW4iLCJvbnVwZ3JhZGVuZWVkZWQiLCJldmVudCIsImRiIiwia2V5bGlzdCIsIm9ianN0b3JlIiwidGFyZ2V0IiwicmVzdWx0IiwiY3JlYXRlT2JqZWN0U3RvcmUiLCJrZXlQYXRoIiwiY3JlYXRlSW5kZXgiLCJ1bmlxdWUiLCJtdWx0aUVudHJ5IiwicHV0Iiwia2V5IiwidmFsIiwib25zdWNjZXNzIiwib25lcnJvciIsImFzeW5jIiwiZ2V0SXRlbSIsImluZGV4T2YiLCJwdXNoIiwic2V0SXRlbSIsImluZGV4Iiwic3BsaWNlIiwib2JqZWN0U3RvcmUiLCJyZXF1ZXN0IiwiX19jb25uZWN0REIiLCJ0cmFuc2FjdGlvbiIsImNvdW50IiwiY2xvc2UiLCJsZW4iLCJlcnJvciIsInBhcnNlSW50Iiwic3RvcmVuYW1lIiwiZ2V0IiwiX19hZGRLZXlsaXN0Iiwib25jb21wbGV0ZSIsImRlbGV0ZSIsIl9fcmVtb3ZlS2V5bGlzdCIsImNsZWFyIl0sIm1hcHBpbmdzIjoiQUFLQSxJQUFJQSxhQUVKQSxhQUFlLE1BQ2JDLFlBQVlDLEdBR1JDLEtBQUtDLFNBRE8sTUFBVEYsR0FDYUEsRUFBTUcsVUFFTixHQUdsQkYsS0FBS0csUUFBVSxFQUVmSCxLQUFLSSxrQkFBZSxFQUNwQkosS0FBS0sseUJBQXNCLEVBQzNCTCxLQUFLTSxzQkFBbUIsRUFDeEJOLEtBQUtPLGdCQUFhLEVBQ2RDLE9BQU9D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