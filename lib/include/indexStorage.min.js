var indexStorage;indexStorage=class{constructor(e){this.node_env=null!=e&&e.NODE_ENV||"",this.version=1,this.__indexDBObj=void 0,this.__IDBTransactionObj=void 0,this.__IDBKeyRangeObj=void 0,this.__database=void 0,window.indexedDB&&(this.__indexDBObj=window.indexedDB,this.__IDBTransactionObj=window.IDBTransaction,this.__IDBKeyRangeObj=window.IDBKeyRange,"develop"===this.node_env?this.__dbname="__indexstorage_db_develop__":this.__dbname="__indexstorage_db_production__")}__connectDB(){return new Promise((e,t)=>{var r;return(r=this.__indexDBObj.open(this.__dbname,this.version)).onupgradeneeded=(e=>{var t,r,a;return(a=(t=e.target.result).createObjectStore("indexStorage",{keyPath:"key"})).createIndex("primary_key","key",{unique:!0,multiEntry:!1}),(a=t.createObjectStore("preference",{keyPath:"key"})).createIndex("primary_key","key",{unique:!0,multiEntry:!1}),r=[],a.put({key:"keylist",val:r})}),r.onsuccess=(t=>(this.__database=t.target.result,e(!0))),r.onerror=(e=>t(!1))})}__addKeylist(e){return new Promise(async(t,r)=>{var a;return(a=await this.getItem("keylist","preference")||[]).indexOf(e)<0?(a.push(e),this.setItem("keylist",a,"preference").then(()=>t(a))):t(a)})}__removeKeylist(e){return new Promise(async(t,r)=>{var a,n;return(a=(n=await this.getItem("keylist","preference")||[]).indexOf(e))>=0&&(n.splice(a,1),await this.setItem("keylist",n,"preference")),t(n)})}length(){return new Promise(async(e,t)=>{var r,a;try{return await this.__connectDB(),r=this.__database.transaction(["indexStorage"],"readonly").objectStore("indexStorage"),(a=r.count()).onerror=(e=>(this.__database.close(),t(void 0))),a.onsuccess=(t=>{var r;return r=a.result,e(r)})}catch(e){}})}key(e){return new Promise(async(t,r)=>{try{return t((await this.getItem("keylist","preference")||[])[parseInt(e)])}catch(e){return e,r(void 0)}})}getItem(e,t="indexStorage"){return new Promise(async(r,a)=>{var n,s;return await this.__connectDB(),n=this.__database.transaction([t],"readonly").objectStore(t),(s=n.get(e)).onerror=(e=>(this.__database.close(),a(void 0))),s.onsuccess=(t=>{var a;return a=void 0,null!=s.result&&s.result.key===e&&(a=s.result.val),this.__database.close(),r(a)})})}setItem(e,t,r="indexStorage"){return new Promise(async(a,n)=>{var s;return await this.__connectDB(),(s=this.__database.transaction([r],"readwrite")).objectStore(r).put({key:e,val:t}),s.onerror=(e=>(this.__database.close(),n(!1))),s.oncomplete=(async t=>{return"indexStorage"===r&&await this.__addKeylist(e),this.__database.close(),a(!0)})})}removeItem(e,t="indexStorage"){return new Promise(async(r,a)=>{var n;return await this.__connectDB(),(n=this.__database.transaction([t],"readwrite").objectStore(t).delete(e)).onerror=(e=>(this.__database.close(),a(!1))),n.onsuccess=(async t=>(await this.__removeKeylist(e),this.__database.close(),r(!0)))})}clear(){return new Promise(async(e,t)=>{var r;return r=await this.__clearObjectStore("indexStorage"),e(r|=await this.__clearObjectStore("preference"))})}delete(e=this.__dbname){return this.__indexDBObj.deleteDatabase(e)}__clearObjectStore(e="indexStorage"){return new Promise(async(t,r)=>{var a;return await this.__connectDB(),(a=this.__database.transaction([e],"readwrite").objectStore(e).clear()).onerror=(e=>(this.__database.close(),r(!1))),a.onsuccess=(e=>(this.__database.close(),t(!0)))})}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIjAiXSwibmFtZXMiOlsiaW5kZXhTdG9yYWdlIiwiW29iamVjdCBPYmplY3RdIiwicGFyYW0iLCJ0aGlzIiwibm9kZV9lbnYiLCJOT0RFX0VOViIsInZlcnNpb24iLCJfX2luZGV4REJPYmoiLCJfX0lEQlRyYW5zYWN0aW9uT2JqIiwiX19JREJLZXlSYW5nZU9iaiIsIl9fZGF0YWJhc2UiLCJ3aW5kb3ciLCJpbmRleGVkREIiLCJJREJUcmFuc2FjdGlvbiIsIklEQktleVJhbmdlIiwiX19kYm5hbWUiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsInJlcU9iaiIsIm9wZW4iLCJvbnVwZ3JhZGVuZWVkZWQiLCJldmVudCIsImRiIiwia2V5bGlzdCIsIm9ianN0b3JlIiwidGFyZ2V0IiwicmVzdWx0IiwiY3JlYXRlT2JqZWN0U3RvcmUiLCJrZXlQYXRoIiwiY3JlYXRlSW5kZXgiLCJ1bmlxdWUiLCJtdWx0aUVudHJ5IiwicHV0Iiwia2V5IiwidmFsIiwib25zdWNjZXNzIiwib25lcnJvciIsImFzeW5jIiwiZ2V0SXRlbSIsImluZGV4T2YiLCJwdXNoIiwic2V0SXRlbSIsInRoZW4iLCJpbmRleCIsInNwbGljZSIsIm9iamVjdFN0b3JlIiwicmVxdWVzdCIsIl9fY29ubmVjdERCIiwidHJhbnNhY3Rpb24iLCJjb3VudCIsImNsb3NlIiwibGVuIiwiZXJyb3IiLCJwYXJzZUludCIsInN0b3JlbmFtZSIsImdldCIsIm9uY29tcGxldGUiLCJfX2FkZEtleWxpc3QiLCJkZWxldGUiLCJfX3JlbW92ZUtleWxpc3QiLCJyZXQiLCJfX2NsZWFyT2JqZWN0U3RvcmUiLCJkYXRhYmFzZSIsImRlbGV0ZURhdGFiYXNlIiwiY2xlYXIiXSwibWFwcGluZ3MiOiJBQUtBLElBQUlBLGFBRUpBLGFBQWUsTUFDYkMsWUFBWUMsR0FHUkMsS0FBS0MsU0FETyxNQUFURixHQUNhQSxFQUFNRyxVQUVOLEdBR2xCRixLQUFLRyxRQUFVLEVBRWZILEtBQUtJLGtCQUFlLEVBQ3BCSixL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