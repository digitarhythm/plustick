var indexStorage;indexStorage=class{constructor(e){this.node_env=null!=e&&e.NODE_ENV||"",this.version=1,this.__indexDBObj=void 0,this.__IDBTransactionObj=void 0,this.__IDBKeyRangeObj=void 0,this.__database=void 0,window.indexedDB&&(this.__indexDBObj=window.indexedDB,this.__IDBTransactionObj=window.IDBTransaction,this.__IDBKeyRangeObj=window.IDBKeyRange,"develop"===this.node_env?this.__dbname="__indexstorage_db_develop__":this.__dbname="__indexstorage_db_production__")}__connectDB(){return new Promise((e,t)=>{var r;return(r=this.__indexDBObj.open(this.__dbname,this.version)).onupgradeneeded=(e=>{var t,r,a;return(a=(t=e.target.result).createObjectStore("indexStorage",{keyPath:"key"})).createIndex("primary_key","key",{unique:!0,multiEntry:!1}),(a=t.createObjectStore("preference",{keyPath:"key"})).createIndex("primary_key","key",{unique:!0,multiEntry:!1}),r=[],a.put({key:"keylist",val:r})}),r.onsuccess=(t=>(this.__database=t.target.result,e(!0))),r.onerror=(e=>t(!1))})}__addKeylist(e){return new Promise(async(t,r)=>{var a;return(a=await this.getItem("keylist","preference")||[]).indexOf(e)<0&&(a.push(e),await this.setItem("keylist",a,"preference")),t(a)})}__removeKeylist(e){return new Promise(async(t,r)=>{var a,n;return(a=(n=await this.getItem("keylist","preference")||[]).indexOf(e))>=0&&(n.splice(a,1),await this.setItem("keylist",n,"preference")),t(n)})}length(){return new Promise(async(e,t)=>{var r,a;try{return await this.__connectDB(),r=this.__database.transaction(["indexStorage"],"readonly").objectStore("indexStorage"),(a=r.count()).onerror=(e=>(this.__database.close(),t(void 0))),a.onsuccess=(t=>{var r;return r=a.result,e(r)})}catch(e){}})}key(e){return new Promise(async(t,r)=>{try{return t((await this.getItem("keylist","preference")||[])[parseInt(e)])}catch(e){return e,r(void 0)}})}getItem(e,t="indexStorage"){return new Promise(async(r,a)=>{var n,s;return await this.__connectDB(),n=this.__database.transaction([t],"readonly").objectStore(t),(s=n.get(e)).onerror=(e=>(this.__database.close(),a(void 0))),s.onsuccess=(t=>{var a;return a=void 0,null!=s.result&&s.result.key===e&&(a=s.result.val),this.__database.close(),r(a)})})}setItem(e,t,r="indexStorage"){return new Promise(async(a,n)=>{var s;return await this.__connectDB(),(s=this.__database.transaction([r],"readwrite")).objectStore(r).put({key:e,val:t}),"indexStorage"===r&&await this.__addKeylist(e),s.onerror=(e=>(this.__database.close(),n(!1))),s.oncomplete=(e=>(this.__database.close(),a(!0)))})}removeItem(e,t="indexStorage"){return new Promise(async(r,a)=>{var n;return await this.__connectDB(),(n=this.__database.transaction([t],"readwrite").objectStore(t).delete(e)).onerror=(e=>(this.__database.close(),a(!1))),n.onsuccess=(async t=>(await this.__removeKeylist(e),this.__database.close(),r(!0)))})}clear(){return new Promise(async(e,t)=>{var r;return r=await this.__clearObjectStore("indexStorage"),e(r|=await this.__clearObjectStore("preference"))})}delete(e=this.__dbname){return this.__indexDBObj.deleteDatabase(e)}__clearObjectStore(e="indexStorage"){return new Promise(async(t,r)=>{var a;return await this.__connectDB(),(a=this.__database.transaction([e],"readwrite").objectStore(e).clear()).onerror=(e=>(this.__database.close(),r(!1))),a.onsuccess=(e=>(this.__database.close(),t(!0)))})}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIjAiXSwibmFtZXMiOlsiaW5kZXhTdG9yYWdlIiwiW29iamVjdCBPYmplY3RdIiwicGFyYW0iLCJ0aGlzIiwibm9kZV9lbnYiLCJOT0RFX0VOViIsInZlcnNpb24iLCJfX2luZGV4REJPYmoiLCJfX0lEQlRyYW5zYWN0aW9uT2JqIiwiX19JREJLZXlSYW5nZU9iaiIsIl9fZGF0YWJhc2UiLCJ3aW5kb3ciLCJpbmRleGVkREIiLCJJREJUcmFuc2FjdGlvbiIsIklEQktleVJhbmdlIiwiX19kYm5hbWUiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsInJlcU9iaiIsIm9wZW4iLCJvbnVwZ3JhZGVuZWVkZWQiLCJldmVudCIsImRiIiwia2V5bGlzdCIsIm9ianN0b3JlIiwidGFyZ2V0IiwicmVzdWx0IiwiY3JlYXRlT2JqZWN0U3RvcmUiLCJrZXlQYXRoIiwiY3JlYXRlSW5kZXgiLCJ1bmlxdWUiLCJtdWx0aUVudHJ5IiwicHV0Iiwia2V5IiwidmFsIiwib25zdWNjZXNzIiwib25lcnJvciIsImFzeW5jIiwiZ2V0SXRlbSIsImluZGV4T2YiLCJwdXNoIiwic2V0SXRlbSIsImluZGV4Iiwic3BsaWNlIiwib2JqZWN0U3RvcmUiLCJyZXF1ZXN0IiwiX19jb25uZWN0REIiLCJ0cmFuc2FjdGlvbiIsImNvdW50IiwiY2xvc2UiLCJsZW4iLCJlcnJvciIsInBhcnNlSW50Iiwic3RvcmVuYW1lIiwiZ2V0IiwiX19hZGRLZXlsaXN0Iiwib25jb21wbGV0ZSIsImRlbGV0ZSIsIl9fcmVtb3ZlS2V5bGlzdCIsInJldCIsIl9fY2xlYXJPYmplY3RTdG9yZSIsImRhdGFiYXNlIiwiZGVsZXRlRGF0YWJhc2UiLCJjbGVhciJdLCJtYXBwaW5ncyI6IkFBS0EsSUFBSUEsYUFFSkEsYUFBZSxNQUNiQyxZQUFZQyxHQUdSQyxLQUFLQyxTQURPLE1BQVRGLEdBQ2FBLEVBQU1HLFVBRU4sR0FHbEJGLEtBQUtHLFFBQVUsRUFFZkgsS0FBS0ksa0JBQWUsRUFDcEJKLEtBQUtLLHlC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