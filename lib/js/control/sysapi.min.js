var NODE_ENV,Promise,bind_router,config,echo,express,fs,path,pathinfo,router;Promise=require("bluebird"),router=(express=require("express")).Router(),path=require("path"),config=require("config"),echo=require("ndlog").echo,bind_router=global.BIND_ROUTER,fs=require("fs-extra"),pathinfo=require(`${PLUSTICKLIBS}/pathinfo.min.js`),router.use(express.json()),router.use(express.urlencoded({extended:!0})),NODE_ENV=process.env.NODE_ENV,router.all("/:endpoint",async function(e,r){var o,n,i,t,s,u,a,p,f,d,h,c;if(f=e.method,n=e.params.endpoint,o=e.body,d=e.query,(t=e.headers).method=f,"develop"===NODE_ENV||t.origin===(t.referer.replace(/\/\?.*$/,"")||"").replace(/\/$/,"")){if("__getappsinfo__"===n){for(h=function(e){return new Promise(function(r,o){return fs.readdir(e,function(e,n){return e?o(e):r(n)})})},u={},p=await h(pathinfo.usrjsview).catch(e=>echo(e)),u.userjsview=[],s=0,a=p.length;s<a;s++)(i=p[s]).match(/^.*\.min\.js$/)&&null===i.match(/appsmain\.min\.js$/)&&u.userjsview.push(`${pathinfo.pkgname}/view/${i}`);return r.json({jrror:0,pathinfo:pathinfo,jsfilelist:u})}return null!=bind_router[n]&&"function"==typeof bind_router[n]?(c=await bind_router[n](t,o,d),r.json(c)):void 0}r.json(-1)}),module.exports=router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIjAiXSwibmFtZXMiOlsiTk9ERV9FTlYiLCJQcm9taXNlIiwiYmluZF9yb3V0ZXIiLCJjb25maWciLCJlY2hvIiwiZXhwcmVzcyIsImZzIiwicGF0aCIsInBhdGhpbmZvIiwicm91dGVyIiwicmVxdWlyZSIsIlJvdXRlciIsImdsb2JhbCIsIkJJTkRfUk9VVEVSIiwiUExVU1RJQ0tMSUJTIiwidXNlIiwianNvbiIsInVybGVuY29kZWQiLCJleHRlbmRlZCIsInByb2Nlc3MiLCJlbnYiLCJhbGwiLCJhc3luYyIsInJlcSIsInJlcyIsImRhdGEiLCJlbmRwb2ludCIsImZuYW1lIiwiaGVhZGVycyIsImkiLCJqc2ZpbGVsaXN0IiwibGVuIiwibGlzdHMiLCJtZXRob2QiLCJxdWVyeSIsInJlYWRGaWxlTGlzdCIsInJldCIsInBhcmFtcyIsImJvZHkiLCJvcmlnaW4iLCJyZWZlcmVyIiwicmVwbGFjZSIsInJlc29sdmUiLCJyZWplY3QiLCJyZWFkZGlyIiwiZXJyIiwidXNyanN2aWV3IiwiY2F0Y2giLCJlIiwibGVuZ3RoIiwibWF0Y2giLCJwdXNoIiwicGtnbmFtZSIsImpycm9yIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSUEsU0FBVUMsUUFBU0MsWUFBYUMsT0FBUUMsS0FBTUMsUUFBU0MsR0FBSUMsS0FBTUMsU0FBVUMsT0FFL0VSLFFBQVVTLFFBQVEsWUFJbEJELFFBRkFKLFFBQVVLLFFBQVEsWUFFREMsU0FFakJKLEtBQU9HLFFBQVEsUUFFZlAsT0FBU08sUUFBUSxVQUVqQk4sS0FBT00sUUFBUSxTQUFTTixLQUV4QkYsWUFBY1UsT0FBT0MsWUFFckJQLEdBQUtJLFFBQVEsWUFFYkYsU0FBV0UsV0FBV0ksZ0NBRXRCTCxPQUFPTSxJQUFJVixRQUFRVyxRQUVuQlAsT0FBT00sSUFBSVYsUUFBUVksV0FBVyxDQUM1QkMsVUFBVSxLQUdabEIsU0FBV21CLFFBQVFDLElBQWMsU0FLakNYLE9BQU9ZLElBQUksYUFBY0MsZUFBZUMsRUFBS0MsR0FDM0MsSUFBSUMsRUFBTUMsRUFBVUMsRUFBT0MsRUFBU0MsRUFBR0MsRUFBWUMsRUFBS0MsRUFBT0MsRUFBZ0JDLEVBQU9DLEVBQXVCQyxFQU83RyxHQU5BSCxFQUFTVixFQUFJVSxPQUNiUCxFQUFXSCxFQUFJYyxPQUFPWCxTQUN0QkQsRUFBT0YsRUFBSWUsS0FDWEosRUFBUVgsRUFBSVcsT0FDWk4sRUFBVUwsRUFBSUssU0FDRSxPQUFJSyxFQUNILFlBQWJqQyxVQUNPNEIsRUFBUVcsVUFDUFgsRUFBUVksUUFBUUMsUUFBUSxVQUFXLEtBQU8sSUFDN0JBLFFBQVEsTUFBTyxJQUh4QyxDQVdBLEdBQWlCLG9CQUFiZixFQUFnQyxDQWtCbEMsSUFqQkFTLEVBQWUsU0FBUzVCLEdBQ3RCLE9BQU8sSUFBSU4sUUFBUSxTQUFTeUMsRUFBU0MsR0FDbkMsT0FBT3JDLEdBQUdzQyxRQUFRckMsRUFBTSxTQUFTc0MsRUFBS2IsR0FDcEMsT0FBSWEsRUFDS0YsRUFBT0UsR0FFUEgsRUFBUVYsUUFNdkJGLEVBQWEsR0FDYkUsUUFBZUcsRUFBYTNCLFNBQVNzQyxXQUFXQyxNQUFPQyxHQUM5QzVDLEtBQUs0QyxJQUVkbEIsRUFBdUIsV0FBSSxHQUN0QkQsRUFBSSxFQUFHRSxFQUFNQyxFQUFNaUIsT0FBUXBCLEVBQUlFLEVBQUtGLEtBQ3ZDRixFQUFRSyxFQUFNSCxJQUNKcUIsTUFBTSxrQkFDNEIsT0FBdEN2QixFQUFNdUIsTUFBTSx1QkFDZHBCLEVBQXVCLFdBQUVxQixRQUFRM0MsU0FBUzRDLGdCQUFnQnpCLEtBSWhFLE9BQU9ILEVBQUlSLEtBQUssQ0FDZHFDLE1BQU8sRUFDUDdDLFNBQVVBLFNBQ1ZzQixXQUFZQSxJQUdkLE9BQThCLE1BQXpCNUIsWUFBWXdCLElBQXVELG1CQUExQnhCLFlBQVl3QixJQUN4RFUsUUFBYWxDLFlBQVl3QixHQUFVRSxFQUFTSCxFQUFNUyxHQUMzQ1YsRUFBSVIsS0FBS29CLFNBRmxCLEVBdkNFWixFQUFJUixNQUFNLEtBOENoQnNDLE9BQU9DLFFBQVU5QyJ9